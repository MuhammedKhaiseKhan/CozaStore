<%- include('../layouts/userLayout/header.ejs')%>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">

<style>
  .login-with-google-btn {
  transition: background-color .3s, box-shadow .3s;
    
  padding: 12px 16px 12px 42px;
  border: none;
  border-radius: 3px;
  box-shadow: 0 -1px 0 rgba(0, 0, 0, .04), 0 1px 1px rgba(0, 0, 0, .25);
  
  color: #757575;
  font-size: 14px;
  font-weight: 500;
  font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",sans-serif;
  
  background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48cGF0aCBkPSJNMTcuNiA5LjJsLS4xLTEuOEg5djMuNGg0LjhDMTMuNiAxMiAxMyAxMyAxMiAxMy42djIuMmgzYTguOCA4LjggMCAwIDAgMi42LTYuNnoiIGZpbGw9IiM0Mjg1RjQiIGZpbGwtcnVsZT0ibm9uemVybyIvPjxwYXRoIGQ9Ik05IDE4YzIuNCAwIDQuNS0uOCA2LTIuMmwtMy0yLjJhNS40IDUuNCAwIDAgMS04LTIuOUgxVjEzYTkgOSAwIDAgMCA4IDV6IiBmaWxsPSIjMzRBODUzIiBmaWxsLXJ1bGU9Im5vbnplcm8iLz48cGF0aCBkPSJNNCAxMC43YTUuNCA1LjQgMCAwIDEgMC0zLjRWNUgxYTkgOSAwIDAgMCAwIDhsMy0yLjN6IiBmaWxsPSIjRkJCQzA1IiBmaWxsLXJ1bGU9Im5vbnplcm8iLz48cGF0aCBkPSJNOSAzLjZjMS4zIDAgMi41LjQgMy40IDEuM0wxNSAyLjNBOSA5IDAgMCAwIDEgNWwzIDIuNGE1LjQgNS40IDAgMCAxIDUtMy43eiIgZmlsbD0iI0VBNDMzNSIgZmlsbC1ydWxlPSJub256ZXJvIi8+PHBhdGggZD0iTTAgMGgxOHYxOEgweiIvPjwvZz48L3N2Zz4=);
  background-color: white;
  background-repeat: no-repeat;
  background-position: 12px 11px;
  
  &:hover {
    box-shadow: 0 -1px 0 rgba(0, 0, 0, .04), 0 2px 4px rgba(0, 0, 0, .25);
  }
  
  &:active {
    background-color: #eeeeee;
  }
  
  &:focus {
    outline: none;
    box-shadow: 
      0 -1px 0 rgba(0, 0, 0, .04),
      0 2px 4px rgba(0, 0, 0, .25),
      0 0 0 3px #c8dafc;
  }
  
  &:disabled {
    filter: grayscale(100%);
    background-color: #ebebeb;
    box-shadow: 0 -1px 0 rgba(0, 0, 0, .04), 0 1px 1px rgba(0, 0, 0, .25);
    cursor: not-allowed;
  }
}
</style>

<div class="wrapper" style="background-image: url('/reg/images/bg-registration-form-1.jpg');">
    <div class="inner">
        <div class="image-holder">
            <img src="/reg/images/registration-form-1.jpg" alt="">
        </div>
        <form id="Regform" action="/register" method="post">
            <h3>Registration Form</h3>
            <div class="form-group">
                <input type="text" placeholder="First Name" name="fname" class="form-control" required>
                <input type="text" placeholder="Last Name" name="sname" class="form-control" required>
            </div>
            <div class="form-wrapper">
                <input type="text" placeholder="Username" name="username" class="form-control" required>
                <i class="zmdi zmdi-account"></i>
            </div>
            <div class="form-wrapper">
                <input type="text" placeholder="Email Address" name="email" class="form-control" required>
                <i class="zmdi zmdi-email"></i>
            </div>
            <div class="form-wrapper">
                <input type="text" placeholder="Mobile number" name="number" class="form-control" required>
                <i class="zmdi zmdi-phone" style="font-size: 17px"></i>
            </div>
            <div class="form-wrapper">
                <input type="password" placeholder="Password" name="password" class="form-control" required>
                <i class="zmdi zmdi-lock"></i>
            </div>
            <div class="form-wrapper">
                <input type="password" placeholder="Confirm Password" name="confirm-password" class="form-control" required>
                <i class="zmdi zmdi-lock"></i>
            </div>
            <div id="error-messages" style="color: red;">

              <%
              if(typeof message !== 'undefined'){
                   %>
              <p style="color: red;"><%= message %></p>
                  <%  
                  }
              %>

            </div>
            <div style="display: flex;">
            <button type="submit">Register
                <i class="zmdi zmdi-arrow-right"></i>
            </button>
              <a href="/auth/google" class="button-wrapper">
                  <button type="button" class="login-with-google-btn">
                      Sign in with Google
                  </button>
              </a>
            </div>
            <div class="mt-2" >
              <p style="margin-left: 17px;" >Already have an account? click on<a href="login" style="margin-left: 10px;">login</a></p>
              </div>
              
              
        </form>
    </div>
</div>




<script>
    function validateForm() {

const firstName = document.getElementsByName("fname")[0];
const lastName = document.getElementsByName("sname")[0];
const username = document.getElementsByName("username")[0];
const email = document.getElementsByName("email")[0];
const mobileNumber = document.getElementsByName("number")[0];
const password = document.getElementsByName("password")[0];
const confirmPassword = document.getElementsByName("confirm-password")[0];


const errorMessages = document.getElementById("error-messages");
if (errorMessages) {
  errorMessages.innerHTML = "";
}


let isValid = true;
const errorMessageList = [];

// Validate Name (both first and last)
const nameValidationRegex = /^[a-zA-Z]+$/;  // Only letters allowed
if (!firstName.value.trim() || !lastName.value.trim()) {
  errorMessageList.push("First and Last Name cannot be empty.");
} else if (!firstName.value.match(nameValidationRegex) || !lastName.value.match(nameValidationRegex)) {
  errorMessageList.push("Name should only contain letters and no spaces.");
}

// Validate Mobile Number
const mobileValidationRegex = /^\d{10}$/;  // Exactly 10 digits
if (!mobileNumber.value.match(mobileValidationRegex) || mobileNumber.value === "0000000000") {
  errorMessageList.push("Mobile number must be 10 digits and cannot be all zeros.");
}

// Validate Email 
const emailValidationRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
if (!email.value.trim() || !email.value.match(emailValidationRegex)) {
  errorMessageList.push("Please enter a valid email address.");
}

// Validate password 
const passwordMinLength = 8;  // Minimum password length
if (password.value.length < passwordMinLength) {
  errorMessageList.push(`Password must be at least ${passwordMinLength} characters long.`);
}

// Validate confirm password (match with password)
if (confirmPassword.value !== password.value) {
  errorMessageList.push("Passwords do not match.");
}


if (errorMessageList.length > 0) {
  isValid = false;
  let errorMessage = "<b>Please fix the following errors:</b><br>";
  errorMessage += errorMessageList.join("<br>");
  if (errorMessages) {
    errorMessages.innerHTML = errorMessage;
  } else {
    alert(errorMessage);
  }
}

return isValid;
}


document.addEventListener('DOMContentLoaded', function () {
const form = document.getElementById("Regform");
if (form) {
    form.addEventListener("submit", function(event) {
        if (!validateForm()) {
            event.preventDefault();  
        }
    });
}
});
</script>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        // Function to get URL parameters
        function getQueryParam(param) {
            let urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        // Check if 'blocked' parameter is present in the URL
        if (getQueryParam('blocked') === 'true') {
            Swal.fire({
                icon: 'error',
                title: 'Blocked Account',
                text: 'Your account is blocked by the admin.',
                confirmButtonText: 'OK'
            });
        }
    </script>


<%- include('../layouts/userLayout/footer.ejs')%>